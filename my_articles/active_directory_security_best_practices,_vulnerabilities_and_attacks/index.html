<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Active Directory Security Best Practices, Vulnerabilities and Attacks</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Source+Sans+Pro:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary: #2a4365;
            --primary-light: #4299e1;
            --secondary: #c05621;
            --text: #2d3748;
            --text-light: #4a5568;
            --background: #f7fafc;
            --card-bg: #ffffff;
            --border: #e2e8f0;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --radius: 8px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Source Sans Pro', sans-serif;
            line-height: 1.8;
            color: var(--text);
            background-color: var(--background);
            padding: 0;
            margin: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background-color: var(--primary);
            color: white;
            padding: 80px 0 40px;
            margin-bottom: 60px;
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--primary-light), var(--secondary));
        }

        .header-content {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
            position: relative;
            z-index: 1;
        }

        h1 {
            font-family: 'Playfair Display', serif;
            font-size: 2.8rem;
            margin-bottom: 20px;
            line-height: 1.3;
            color: white;
        }

        .meta {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.95rem;
        }

        .meta i {
            margin-right: 5px;
            color: var(--primary-light);
        }

        .article-container {
            display: grid;
            grid-template-columns: 1fr min(800px, 100%) 1fr;
            margin-bottom: 80px;
        }

        .article-container > * {
            grid-column: 2;
        }

        .content {
            background-color: var(--card-bg);
            padding: 50px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            font-size: 1.1rem;
            color: var(--text);
        }

        .content p {
            margin-bottom: 1.5em;
        }

        .content img.blog-image {
            max-width: 100%;
            height: auto;
            margin: 40px auto;
            display: block;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .content img.blog-image:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .image-container {
            margin: 40px 0;
            text-align: center;
        }

        .image-container figcaption {
            margin-top: 10px;
            font-size: 0.9rem;
            color: var(--text-light);
            font-style: italic;
        }

        .section-heading {
            font-family: 'Playfair Display', serif;
            color: var(--primary);
            margin: 60px 0 30px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border);
            font-size: 1.8rem;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
            font-size: 0.95rem;
            box-shadow: var(--shadow);
            border-radius: var(--radius);
            overflow: hidden;
        }

        .data-table th, .data-table td {
            padding: 12px 15px;
            text-align: left;
            border: 1px solid var(--border);
        }

        .data-table th {
            background-color: var(--primary);
            color: white;
            font-weight: 600;
        }

        .data-table tr:nth-child(even) {
            background-color: var(--background);
        }

        .table-container {
            margin: 40px 0;
            overflow-x: auto;
        }

        .code-block {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: var(--radius);
            overflow-x: auto;
            margin: 30px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        blockquote {
            border-left: 4px solid var(--primary-light);
            padding: 20px;
            margin: 30px 0;
            background-color: var(--background);
            font-style: italic;
            color: var(--text-light);
        }

        blockquote::before {
            content: '“';
            font-size: 3rem;
            color: var(--primary-light);
            line-height: 0;
            vertical-align: -0.4em;
            margin-right: 10px;
        }

        a {
            color: var(--primary-light);
            text-decoration: none;
            transition: var(--transition);
        }

        a:hover {
            color: var(--secondary);
            text-decoration: underline;
        }

        footer {
            text-align: center;
            padding: 30px 0;
            margin-top: 60px;
            border-top: 1px solid var(--border);
            color: var(--text-light);
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .container {
                padding: 0 15px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .content {
                padding: 30px;
            }
            
            .article-container {
                grid-template-columns: 1fr;
            }
        }
    </style>

</head>
<body>
    <header>
        <h1>Active Directory Security Best Practices, Vulnerabilities and Attacks</h1>
        <div class="meta">
            <span class="date">April 8, 2025</span> • <span class="author">kgsflink</span>
        </div>
    </header>
    
    <article class="content">
        <article class="the-post post-13162 post type-post status-publish format-standard category-technical" id="post-13162">
<header class="post-header the-post-header cf">

<div class="featured">
</div>
</header><!-- .post-header -->
<div class="post-content description cf entry-content content-spacious">
<figure class="wp-block-image size-full"><img alt="Active Directory Security Best Practices, Vulnerabilities and Attacks" class="wp-image-13163" decoding="async" fetchpriority="high" height="430" sizes="(max-width: 900px) 100vw, 900px" src="images/1_active_directory_security_best_practices,_vulnerabilities_and_attacks.png" width="900"/></figure>
<span id="more-13162"></span>
<h2 class="wp-block-heading">Introduction</h2>
<p>Active Directory (AD) is at the heart IT infrastructures. It manages identities, access and network resources. However, it is often poorly secured, making it a prime target for attackers.</p>
<p>An Active Directory compromise can have disastrous consequences. An attacker who gains control can access the entire network, steal data and deploy malicious softwares. In this article, we take a look at best practices for securing your Active Directory. In particular, we’ll look at common vulnerabilities and attacks, as well as configuration flaws that can compromise the security of your AD.</p>
<h2 class="wp-block-heading">Comprehensive Guide to Active Directory Security Best Practices</h2>
<div class="wp-block-aioseo-table-of-contents"><ul><li><a href="#understanding-active-directory-and-its-key-role-in-it-infrastructures">Understanding Active Directory and its Key Role in IT Infrastructures</a><ul><li><a href="#what-is-active-directory">What is Active Directory?</a></li><li><a href="#why-is-ad-security-crucial">Why is AD security crucial?</a></li></ul></li><li><a href="#what-are-the-best-practices-for-securing-active-directory">What are the Best Practices for Securing Active Directory?</a><ul><li><a href="#partitioning-active-directory-components-focus-on-the-tier-model">Partitioning Active Directory components: Focus on the Tier Model</a><ul><li><a href="#why-segment-active-directory">Why segment Active Directory?</a></li><li><a href="#understanding-the-three-tier-model">Understanding the three-tier model</a></li><li><a href="#ensuring-hermeticity-between-tiers">Ensuring hermeticity between tiers</a></li></ul></li><li><a href="#reducing-active-directory-attack-surface">Reducing Active Directory attack surface</a><ul><li><a href="#protecting-active-directory-against-kerberoasting">Protecting Active Directory against Kerberoasting</a></li><li><a href="#countering-as-rep-roasting">Countering AS-REP Roasting</a></li><li><a href="#prevent-machines-from-being-added-to-the-ad-domain">Prevent machines from being added to the AD domain</a></li><li><a href="#deactivate-unconstrained-delegation">Deactivate Unconstrained Delegation</a></li></ul></li><li><a href="#hardening-active-directory-security">Hardening Active Directory security</a><ul><li><a href="#strengthening-ldap-channel-binding-signing">Strengthening LDAP: Channel Binding &amp; Signing</a></li><li><a href="#securing-smb-communications-with-smb-signing">Securing SMB communications with SMB Signing</a></li><li><a href="#protecting-sensitive-accounts-with-the-protected-users-group">Protecting sensitive accounts with the Protected Users group</a></li><li><a href="#securing-local-administrator-accounts-with-laps-local-administrator-password-solution">Securing local administrator accounts with LAPS (Local Administrator Password Solution)</a></li></ul></li><li><a href="#monitoring-and-logging-active-directory-events">Monitoring and logging Active Directory events</a><ul><li><a href="#log-activation-and-centralisation-using-a-siem">Log activation and centralisation using a SIEM</a></li><li><a href="#suspicious-activity-detection-and-incident-response">Suspicious activity detection and incident response</a></li><li><a href="#gpo-and-critical-active-directory-modification-monitoring">GPO and critical Active Directory modification monitoring</a></li></ul></li></ul></li><li><a href="#carry-out-a-pentest-to-assess-and-strengthen-the-security-of-your-active-directory">Carry out a pentest to assess and strengthen the security of your Active Directory</a></li><li><a href="#conclusion">Conclusion</a></li></ul></div>
<h2 class="wp-block-heading" id="understanding-active-directory-and-its-key-role-in-it-infrastructures">Understanding Active Directory and its Key Role in IT Infrastructures</h2>
<h3 class="wp-block-heading has-text-color has-link-color wp-elements-9bf67c5e3894caa1c8399fcd8f5150f7" id="what-is-active-directory" style="color:#c0b800">What is Active Directory?</h3>
<p>Active Directory (AD) is a directory service developed by Microsoft. It is the backbone of identity and access management in Windows environments.</p>
<p>Its main objective is to centralise the authentication and administration of resources (users, machines, applications, permissions) within a network.</p>
<p>AD is based on a hierarchical structure organised into <strong>domains</strong>, <strong>forests</strong>, <strong>organisational units (OUs)</strong> and <strong>objects</strong>:</p>
<ul class="wp-block-list">
<li>A domain is a logical entity grouping AD objects under the same management and authentication policy.</li>
<li>A forest is a set of domains that share a common schema but may have distinct policies.</li>
<li>Organisational units are used to organise and structure domain objects according to the organisation of the company (e.g. HR, IT, Accounting departments).</li>
<li>Each resource (user, computer, group, printer, etc.) is an AD object with specific attributes.</li>
</ul>
<p>The <strong>Domain Controller (DC)</strong> is a server that hosts AD and manages user authentication. Its role is to check credentials (username and password) and apply security policies via <strong>Group Policy Objects (GPOs)</strong>.</p>
<p>GPOs can be used to define specific configurations on network machines, such as password rules, connection parameters or access restrictions.</p>
<p>Finally, in terms of authentication, Active Directory relies on two main protocols: <strong><a href="https://www.vaadata.com/blog/what-is-kerberos-kerberos-authentication-explained/" rel="noopener" target="_blank" title="">Kerberos</a></strong> and <strong><a href="https://www.vaadata.com/blog/understanding-ntlm-authentication-and-ntlm-relay-attacks/" rel="noopener" target="_blank" title="">NTLM (NT LAN Manager)</a></strong>.</p>
<h3 class="wp-block-heading has-text-color has-link-color wp-elements-afbe84267b0c18bb1478ae1cc0ad5021" id="why-is-ad-security-crucial" style="color:#c0b800">Why is AD security crucial?</h3>
<p>Active Directory is a critical component of an organisation’s network. It controls access to critical resources: sensitive files, applications, servers and workstations. If compromised, it can jeopardise the entire information system.</p>
<p>An attacker who manages to gain access with a standard user account may try to obtain higher rights. To do this, he can exploit vulnerabilities or misconfigurations: Kerberoasting, misconfigured kerberos delegations, lateral movements, domain controller takeovers, etc.</p>
<p>To reduce these risks, it is essential to secure Active Directory proactively. This involves reducing the attack surface, strict segmentation of access and systems, hardening of systems and advanced intrusion detection.</p>
<p>Let’s take a closer look.</p>
<h2 class="wp-block-heading" id="what-are-the-best-practices-for-securing-active-directory">What are the Best Practices for Securing Active Directory?</h2>
<h3 class="wp-block-heading has-text-color has-link-color wp-elements-7fa2efe6a7ba789585d80ec7d46d6c93" id="partitioning-active-directory-components-focus-on-the-tier-model" style="color:#c0b800">Partitioning Active Directory components: Focus on the Tier Model</h3>
<p>Active Directory security is based on a defence-in-depth approach, and one of the fundamental principles for limiting risks is the partitioning of components.</p>
<p>In an environment where cyber-attacks are becoming increasingly sophisticated, uncontrolled access to the AD can have disastrous consequences for the organisation.</p>
<p>The Tier Model, recommended by ANSSI, enables a strict segmentation to be applied between privilege levels and critical resources.</p>
<p>The aim is simple: to prevent a compromise at user workstations (the most exposed) from leading to privileges being escalated to domain controllers.</p>
<h4 class="wp-block-heading" id="why-segment-active-directory">Why segment Active Directory?</h4>
<p>Segmentation based on the Tier Model offers a number of strategic advantages in terms of cyber security:</p>
<ul class="wp-block-list">
<li><strong>Reduced risk of privilege escalation:</strong> An attacker who compromises a user workstation should never be able to escalate his privileges to servers or domain controllers.</li>
<li><strong>Isolation of critical resources</strong>: Essential systems (domain controllers, servers) are protected from threats from less secure equipment.</li>
<li><strong>Limitation of lateral attacks</strong>: Good segmentation slows down the propagation of an attack within the network, making it more difficult to exploit transversal vulnerabilities.</li>
<li><strong>Better management of access and permissions</strong>: Compartmentalising roles and access prevents administrators or users from having unnecessary rights.</li>
</ul>
<h4 class="wp-block-heading" id="understanding-the-three-tier-model">Understanding the three-tier model</h4>
<p>The Tier Model is based on a hierarchy of privileges and resources administered within the organisation. It is structured in three tiers:</p>
<ul class="wp-block-list">
<li><strong>Tier 0 represents the trusted core of the system. It includes the organisation’s most sensitive systems and accounts</strong>: domain controllers (DCs), AD administrator accounts, identity management servers (PKI, ADFS, etc.) as well as accounts and systems with administrative rights on AD. In fact, a compromise at this level gives the attacker total control over Active Directory and, by extension, over the entire information system.</li>
<li><strong>Tier 1 encompasses the resources essential to the operation of the business</strong>. It includes business and application servers, critical databases, industrial systems and specialised equipment, as well as application server administrator accounts. A compromise at this level could affect critical business data and disrupt internal and external IT services.</li>
<li>Finally, <strong>Tier 2 focuses on user workstations and peripherals (printers, scanners and other connected devices)</strong>. It should also be noted that user workstations are the main entry point for attacks (phishing, malware, malicious code execution). So an attacker seeking to elevate his privileges will almost always start by compromising a standard user account.</li>
</ul>
<figure class="wp-block-image size-large"><img alt="" class="wp-image-13171" data-lazy-sizes="(max-width: 1024px) 100vw, 1024px" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2025/03/anssi-tier-model-securing-ad-1024x511.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2025/03/anssi-tier-model-securing-ad-300x150.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2025/03/anssi-tier-model-securing-ad-1536x767.png 1536w" decoding="async" height="511" src="images/2_anssi-tier-model-securing-ad-1024x511.png" width="1024"/><noscript><img alt="" class="wp-image-13171" decoding="async" height="511" sizes="(max-width: 1024px) 100vw, 1024px" src="images/3_anssi-tier-model-securing-ad-1024x511.png" width="1024"/></noscript><figcaption class="wp-element-caption">Source : ANSSI</figcaption></figure>
<h4 class="wp-block-heading" id="ensuring-hermeticity-between-tiers">Ensuring hermeticity between tiers</h4>
<p>The effectiveness of the Tier Model is based on strict isolation between each tier. A fundamental principle is that a Tier must never administer a higher-level Tier. Here are the essential rules to ensure effective segmentation:</p>
<ul class="wp-block-list">
<li>Firstly, <strong>Tier 0 administrators only use dedicated secure workstations (PAWs)</strong> and never connect to lower-level resources.</li>
<li>Secondly, <strong>Tier 1 servers must never be accessible for administration from a Tier 2 user workstation</strong>.</li>
<li>In addition, <strong>administration accounts and groups must be strictly limited and reviewed regularly</strong>.</li>
<li>Finally, <strong>the use of RDP sessions, PowerShell Remote and other administration tools must be controlled and monitored</strong>.</li>
</ul>
<figure class="wp-block-image size-large"><img alt="" class="wp-image-13174" data-lazy-sizes="(max-width: 1024px) 100vw, 1024px" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2025/04/tier-model-partitioning-1024x574.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2025/04/tier-model-partitioning-300x168.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2025/04/tier-model-partitioning-1536x861.png 1536w" decoding="async" height="574" src="images/3_tier-model-partitioning-1024x574.png" width="1024"/><noscript><img alt="" class="wp-image-13174" decoding="async" height="574" sizes="(max-width: 1024px) 100vw, 1024px" src="images/4_tier-model-partitioning-1024x574.png" width="1024"/></noscript><figcaption class="wp-element-caption">Source : ANSSI</figcaption></figure>
<p>The rigorous application of the Tier Model drastically reduces the possibility of an Active Directory environment being compromised. Indeed, an organisation that effectively partitions its resources and applies strict administrative controls significantly reduces the risks associated with lateral movements and elevation of privileges.</p>
<p>However, this model is not the only solution, but must be combined with other security best practices.</p>
<h3 class="wp-block-heading has-text-color has-link-color wp-elements-ceb9d467f08070bb50a9f33c8f3e99e9" id="reducing-active-directory-attack-surface" style="color:#c0b800">Reducing Active Directory attack surface</h3>
<p>Active Directory is a prime target for attackers seeking to escalate their privileges or move laterally in a network.</p>
<p>Several techniques are used to exploit well-known vulnerabilities in AD services (AD CS, AD DS, AD FS). It is therefore crucial to apply strict controls to reduce the attack surface and minimise the risks.</p>
<h4 class="wp-block-heading" id="protecting-active-directory-against-kerberoasting">Protecting Active Directory against Kerberoasting</h4>
<p><a href="https://www.vaadata.com/blog/what-is-kerberoasting-attack-and-security-tips-explained/" rel="noopener" target="_blank" title="">Kerberoasting</a> is an attack that allows an attacker with a valid account to extract Kerberos service tickets and attempt to crack them offline to recover passwords in clear text.</p>
<p>This works because the service tickets are encrypted with the password hash of the associated service account. If this account uses a weak password, the attacker can break it with tools such as <a href="https://github.com/hashcat/hashcat" rel="noopener" target="_blank" title="">Hashcat</a> and gain access.</p>
<figure class="wp-block-image size-large"><img alt="Kerberoasting" class="wp-image-13075" data-lazy-sizes="(max-width: 1024px) 100vw, 1024px" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2025/03/kerberoasting-attack-1024x392.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2025/03/kerberoasting-attack-300x115.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2025/03/kerberoasting-attack.png 1271w" decoding="async" height="392" src="images/4_kerberoasting.png" width="1024"/><noscript><img alt="Kerberoasting" class="wp-image-13075" decoding="async" height="392" sizes="(max-width: 1024px) 100vw, 1024px" src="images/5_kerberoasting.png" width="1024"/></noscript><figcaption class="wp-element-caption">How kerberoasting works</figcaption></figure>
<p>To reduce the risk of this vulnerability, the following security controls should be implemented:</p>
<ul class="wp-block-list">
<li><strong>Use gMSAs (Group Managed Service Accounts)</strong> for these objects. They will have automatic password management with rotation to prevent passwords being broken.</li>
<li><strong>Limit the privileges of accounts with an SPN (Service Principal Name)</strong> and prevent them from being members of high privilege groups (e.g. Domain Admins) in order to reduce the impact of a compromise.</li>
</ul>
<h4 class="wp-block-heading" id="countering-as-rep-roasting">Countering AS-REP Roasting</h4>
<p>AS-REP Roasting is an attack that targets user accounts configured with the ‘Do not require Kerberos pre-authentication’ option.</p>
<p>An attacker with no privileges can request an authentication ticket (AS-REP) for these accounts and retrieve a response encrypted with the user’s password hash. If this account uses a weak password, the attacker can break it with Hashcat and gain access to the account.</p>
<figure class="wp-block-image size-large"><img alt="How AS-REP Roasting works" class="wp-image-13077" data-lazy-sizes="(max-width: 1024px) 100vw, 1024px" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2025/03/as-rep-roasting-attack-1024x445.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2025/03/as-rep-roasting-attack-300x130.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2025/03/as-rep-roasting-attack-1170x508.png 1170w, https://www.vaadata.com/blog/wp-content/uploads/2025/03/as-rep-roasting-attack.png 1282w" decoding="async" height="445" src="images/5_how_as-rep_roasting_works.png" width="1024"/><noscript><img alt="How AS-REP Roasting works" class="wp-image-13077" decoding="async" height="445" sizes="(max-width: 1024px) 100vw, 1024px" src="images/6_how_as-rep_roasting_works.png" width="1024"/></noscript><figcaption class="wp-element-caption">How AS-REP Roasting works</figcaption></figure>
<p>To reduce the risk of this vulnerability, the following security controls should be implemented:</p>
<ul class="wp-block-list">
<li>Enable Kerberos pre-authentication on all accounts. If an account needs to bypass it, limit its privileges and prevent it from being a member of high-privilege groups (e.g. Domain Admins).</li>
<li>Use strong passwords: minimum 30 characters, making sure they are unique and managed correctly.</li>
</ul>
<h4 class="wp-block-heading" id="prevent-machines-from-being-added-to-the-ad-domain">Prevent machines from being added to the AD domain</h4>
<p>The presence of the <code>MachineAccountQuota</code> attribute comes from a default configuration in Active Directory. This attribute allows any authenticated user to create up to 10 machine accounts in the domain.</p>
<p>An attacker with no privileges can exploit this by registering a new computer, thereby obtaining a machine account with its own credentials. This machine can then be used to carry out various attacks within the domain (including delegation attacks).</p>
<figure class="wp-block-image size-large"><img alt="" class="wp-image-13081" data-lazy-sizes="(max-width: 1024px) 100vw, 1024px" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2025/03/MachineAccountQuota-1024x589.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2025/03/MachineAccountQuota-300x173.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2025/03/MachineAccountQuota.png 1285w" decoding="async" height="589" src="images/6_MachineAccountQuota-1024x589.png" width="1024"/><noscript><img alt="" class="wp-image-13081" decoding="async" height="589" sizes="(max-width: 1024px) 100vw, 1024px" src="images/7_MachineAccountQuota-1024x589.png" width="1024"/></noscript></figure>
<p>To reduce the risk of this vulnerability, simply prevent unprivileged users from adding machines to the domain by setting the <code>MachineAccountQuota</code> attribute to 0.</p>
<h4 class="wp-block-heading" id="deactivate-unconstrained-delegation">Deactivate Unconstrained Delegation</h4>
<p>Unconstrained Delegation is a risky configuration that allows a machine to usurp the identity of users connecting to it in order to access other services.</p>
<p>Unlike Constrained Delegation, which limits these rights to specific services, Unconstrained Delegation allows access to any service.</p>
<p>When a user authenticates to a machine with this configuration, their Kerberos ticket (TGT) is stored in the memory of the LSASS process. An attacker who compromises this computer can extract these tickets and use them to impersonate the user and elevate their privileges. If a domain administrator has logged in, the attacker can retrieve his ticket and take full control of the environment.</p>
<p>There are also techniques for forcing a user to authenticate, which makes this attack even more dangerous.</p>
<p>To reduce the risk of this vulnerability, the following security controls should be implemented:</p>
<ul class="wp-block-list">
<li>Disable Unconstrained Delegation on machine objects or use Resource-Based Constrained Delegation instead if necessary.</li>
<li>Configure privileged accounts as ‘sensitive and non-delegable’.</li>
<li>Add privileged accounts to the ‘Protected Users’ security group to prevent them from being delegated.</li>
<li>Disable the ‘Print Spooler’ service on domain controllers to prevent it being exploited in forced authentication attacks.</li>
</ul>
<h3 class="wp-block-heading has-text-color has-link-color wp-elements-3d93a1fb8e6bcaa9a1db919e446804e6" id="hardening-active-directory-security" style="color:#c0b800">Hardening Active Directory security</h3>
<p>Applying security fixes to an Active Directory environment is an essential first step, but it is not enough to guarantee effective protection. Many of Microsoft’s default configurations are not optimised for security, leaving vulnerabilities that can be exploited by attackers.</p>
<p>It is therefore necessary to reinforce the security posture by implementing additional measures such as restricting administrative access, monitoring connections and hardening communication protocols.</p>
<h4 class="wp-block-heading" id="strengthening-ldap-channel-binding-signing">Strengthening LDAP: Channel Binding &amp; Signing</h4>
<p>LDAP Channel Binding &amp; Signing is a security feature that uses cryptographic mechanisms to strengthen the authentication and confidentiality of Lightweight Directory Access Protocol (LDAP) communications.</p>
<p>By enabling LDAP Signing, LDAP connections are secured against <a href="https://www.vaadata.com/blog/what-is-a-man-in-the-middle-mitm-attack-types-and-security-best-practices/" rel="noopener" target="_blank" title="">Man in the Middle (MitM) attacks</a>, preventing an attacker from intercepting or modifying the data exchanged between a client and a domain controller.</p>
<p>In addition, enabling LDAP Channel Binding reduces the risk of identity theft by requiring a stricter binding between the TLS connection and the underlying LDAP session.</p>
<h4 class="wp-block-heading" id="securing-smb-communications-with-smb-signing">Securing SMB communications with SMB Signing</h4>
<p>SMB (Server Message Block) Signing is a security mechanism that ensures the integrity and authenticity of SMB communications by digitally signing each message exchanged between a client and a server.</p>
<p>By enabling this feature, each SMB request is associated with a cryptographic signing, preventing SMB Relay attacks where an attacker could intercept and replay authenticated communications.</p>
<h4 class="wp-block-heading" id="protecting-sensitive-accounts-with-the-protected-users-group">Protecting sensitive accounts with the Protected Users group</h4>
<p>The Protected Users security group is a feature introduced with Windows Server 2012 R2. It automatically applies enhanced security restrictions to accounts added to it. These restrictions include prohibiting the use of weak authentication methods (such as NTLM, Kerberos with DES/RC4, or unconstrained delegation); thus preventing several types of attack, including Pass the Hash and Pass the Ticket.</p>
<p>Including privileged accounts (such as domain administrators) in this group considerably reduces the attack surface by imposing more secure authentication and limiting the validity period of Kerberos tickets.</p>
<h4 class="wp-block-heading" id="securing-local-administrator-accounts-with-laps-local-administrator-password-solution">Securing local administrator accounts with LAPS (Local Administrator Password Solution)</h4>
<p>Local Administrator Password Solution (LAPS) is a Microsoft solution for automatically managing passwords for local administrator accounts on workstations and servers. LAPS generates and stores unique, complex and regularly renewed passwords for each machine.</p>
<h3 class="wp-block-heading has-text-color has-link-color wp-elements-81710f534b3e97584437851533a0decd" id="monitoring-and-logging-active-directory-events" style="color:#c0b800">Monitoring and logging Active Directory events</h3>
<p>Effective Active Directory monitoring enables suspicious behaviour to be identified quickly and action taken before an attacker compromises the environment.</p>
<p>Implementing detailed logging and real-time monitoring of critical events is essential to maintaining robust security.</p>
<h4 class="wp-block-heading" id="log-activation-and-centralisation-using-a-siem">Log activation and centralisation using a SIEM</h4>
<p>The Windows audit log must be activated to record events linked to connections, changes to Active Directory objects and the creation of accounts.</p>
<p>However, storing these logs locally is insufficient: centralisation with a SIEM (Security Information and Event Management) is necessary to detect and correlate incidents in real time.</p>
<p>Once the logs have been collected, rules need to be defined to identify suspicious activities and trigger automatic alerts.</p>
<h4 class="wp-block-heading" id="suspicious-activity-detection-and-incident-response">Suspicious activity detection and incident response</h4>
<p>Certain events should be monitored closely, as they often indicate an attempted compromise:</p>
<ul class="wp-block-list">
<li>A series of authentication failures on privileged accounts may indicate a <a href="https://www.vaadata.com/blog/brute-force-attacks-principles-and-security-best-practices/" rel="noopener" target="_blank" title="">brute force attack</a>.</li>
<li>Unusual access to sensitive resources (critical servers, databases) may indicate an attempt to exfiltrate data.</li>
<li>The creation of a new account with elevated privileges outside normal processes is a potential sign of privilege escalation.</li>
<li>Any unauthorised modification of GPOs should be analysed immediately, as attackers manipulate them to establish persistence or disable security controls.</li>
</ul>
<p>Integrating automatic alerts on these actions allows security teams to intervene quickly before an attack spreads.</p>
<h4 class="wp-block-heading" id="gpo-and-critical-active-directory-modification-monitoring">GPO and critical Active Directory modification monitoring</h4>
<p>Group Policy Objects (GPOs) play a key role in the configuration and management of workstations and servers within a domain. Attackers often try to modify them to disable protections, create backdoors or propagate malicious payloads.</p>
<p>It is therefore essential to :</p>
<ul class="wp-block-list">
<li>Monitor all changes made to critical GPOs, particularly those applied to domain controllers.</li>
<li>Regularly compare current configurations with defined security standards.</li>
<li>Set up regular snapshots of group policies to detect any suspicious changes.</li>
</ul>
<h2 class="wp-block-heading" id="carry-out-a-pentest-to-assess-and-strengthen-the-security-of-your-active-directory">Carry out a pentest to assess and strengthen the security of your Active Directory</h2>
<p>An <a href="https://www.vaadata.com/blog/active-directory-pentesting-objective-methodology-black-box-and-grey-box-tests/" title="">Active Directory penetration test</a> is an essential exercise for assessing vulnerabilities in the environment and testing the robustness of security controls.</p>
<p>By adopting a proactive approach, vulnerabilities can be corrected before they are exploited, thereby limiting the risk of compromise and ensuring greater resilience in the face of cyber attacks.</p>
<h2 class="wp-block-heading" id="conclusion">Conclusion</h2>
<p>Securing Active Directory is an ongoing task. Initial configuration is not enough: constant monitoring and regular testing are needed to anticipate threats.</p>
<p>A well-protected AD is based on several pillars: reduction of privileges, hardening of configurations, active monitoring and security audits. By applying these best practices, businesses can limit risks and strengthen their resilience in the face of cyber attacks.</p>
<p><strong>Authors: Alexis PARET – Pentester &amp; Amin TRAORÉ – CMO @Vaadata</strong></p>
</div><!-- .post-content -->
<div class="the-post-foot cf">

</div>

</article>
    </article>
</body>
</html>