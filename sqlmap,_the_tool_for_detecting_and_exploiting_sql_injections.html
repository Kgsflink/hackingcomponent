
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sqlmap, the Tool for Detecting and Exploiting SQL Injections</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
        }
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .date {
            color: #7f8c8d;
            font-size: 0.9em;
        }
        .featured-image {
            max-width: 100%;
            height: auto;
            margin: 20px 0;
            border-radius: 5px;
        }
        .content {
            margin-top: 30px;
        }
        img {
            max-width: 100%;
            height: auto;
            margin: 15px 0;
            border-radius: 3px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        h2, h3, h4 {
            color: #2c3e50;
            margin-top: 30px;
        }
        a {
            color: #3498db;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        .wp-block-table table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .wp-block-table th, .wp-block-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .wp-block-table th {
            background-color: #f2f2f2;
        }
        pre {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
        }
        code {
            font-family: 'Courier New', Courier, monospace;
            background-color: #f5f5f5;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <header>
        <h1>Sqlmap, the Tool for Detecting and Exploiting SQL Injections</h1>
        <div class="date">June 7, 2024</div>
        <img src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20807%20417'%3E%3C/svg%3E" alt="Featured Image" class="featured-image">
    </header>
    
    <div class="content">
        <div class="post-content description cf entry-content content-spacious">
 <figure class="wp-block-image size-full">
  <img alt="Sqlmap, the Tool for Detecting and Exploiting SQL Injections" class="wp-image-9463" data-lazy-sizes="(max-width: 807px) 100vw, 807px" data-lazy-src="article_images\image_1.png" data-lazy-srcset="article_images\image_1.png 807w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/exploiting-sqli-with-sqlmap-300x155.png 300w" decoding="async" fetchpriority="high" height="417" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20807%20417'%3E%3C/svg%3E" width="807"/>
  <noscript>
   <img alt="Sqlmap, the Tool for Detecting and Exploiting SQL Injections" class="wp-image-9463" decoding="async" fetchpriority="high" height="417" sizes="(max-width: 807px) 100vw, 807px" src="article_images\image_1.png" srcset="article_images\image_1.png 807w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/exploiting-sqli-with-sqlmap-300x155.png 300w" width="807"/>
  </noscript>
 </figure>
 <span id="more-9735">
 </span>
 <h2 class="wp-block-heading">
  Introduction
 </h2>
 <p>
  Surely one of the best-known vulnerabilities, and one that has been around for a long time, SQL injection is still wreaking havoc in 2024. It is featured in many of our pentest reports every year.
 </p>
 <p>
  Furthermore, compared to 2022, in 2023, SQL injection vulnerabilities were identified as
  <a href="https://www.cvedetails.com/vulnerability-list/year-2023/opsqli-1/sql-injection.html" rel="noopener" target="_blank" title="">
   CVEs 2159 times
  </a>
  . And in the latest OWASP Top 10, which lists the most critical and common vulnerabilities in web applications, they rank third.
 </p>
 <p>
  Depending on the case, an SQL injection can be tedious to exploit to assess its impact. Fortunately, high-quality tools developed by the open-source community, such as sqlmap, make the task much easier.
 </p>
 <p>
  In this article, we’ll review the principle of SQL injections and give an exhaustive presentation of how sqlmap works, using concrete examples.
 </p>
 <h2 class="wp-block-heading">
  Comprehensive Guide to Sqlmap
 </h2>
 <div class="wp-block-aioseo-table-of-contents">
  <ul>
   <li>
    <a href="#a-quick-reminder-about-sql-injections-sqli">
     A Quick Reminder about SQL Injections (SQLi)
    </a>
    <ul>
     <li>
      <a href="#what-is-an-sqli">
       What is an SQLi?
      </a>
     </li>
     <li>
      <a href="#impact-of-an-sqli">
       Impact of an SQLi
      </a>
     </li>
     <li>
      <a href="#what-are-the-different-types-of-sqli-and-how-can-they-be-prevented">
       What are the Different Types of SQLi and How Can They be Prevented?
      </a>
     </li>
    </ul>
   </li>
   <li>
    <a href="#how-does-sqlmap-work">
     How does Sqlmap Work?
    </a>
    <ul>
     <li>
      <a href="#what-is-sqlmap">
       What is Sqlmap?
      </a>
     </li>
     <li>
      <a href="#exploiting-an-sqli-with-sqlmap">
       Exploiting an SQLi with Sqlmap
      </a>
      <ul>
       <li>
        <a href="#finding-a-payload-that-suits-the-type-of-sqli">
         Finding a payload that suits the type of SQLi
        </a>
       </li>
       <li>
        <a href="#exfiltrating-database-names">
         Exfiltrating database names
        </a>
       </li>
       <li>
        <a href="#listing-the-table-names">
         Listing the table names
        </a>
       </li>
       <li>
        <a href="#choosing-an-interesting-table">
         Choosing an interesting table
        </a>
       </li>
       <li>
        <a href="#listing-the-table-data">
         Listing the table data
        </a>
       </li>
      </ul>
     </li>
     <li>
      <a href="#using-sqlmap-to-retrieve-system-information">
       Using Sqlmap to retrieve system information
      </a>
     </li>
     <li>
      <a href="#exploiting-blind-sql-injections-with-sqlmap">
       Exploiting blind SQL injections with Sqlmap
      </a>
     </li>
     <li>
      <a href="#sqlmap-advanced-options">
       Sqlmap advanced options
      </a>
      <ul>
       <li>
        <a href="#proxy">
         –proxy=
        </a>
       </li>
       <li>
        <a href="#delay">
         –delay=
        </a>
       </li>
       <li>
        <a href="#force-ssl">
         –force-ssl
        </a>
       </li>
       <li>
        <a href="#threads">
         –threads=
        </a>
       </li>
       <li>
        <a href="#dbms">
         –dbms=
        </a>
       </li>
       <li>
        <a href="#level">
         –level=
        </a>
       </li>
       <li>
        <a href="#risk">
         –risk=
        </a>
       </li>
       <li>
        <a href="#string">
         –string=
        </a>
       </li>
       <li>
        <a href="#technique">
         –technique=
        </a>
       </li>
       <li>
        <a href="#file-read">
         –file-read=
        </a>
       </li>
       <li>
        <a href="#os-cmd">
         –os-cmd=
        </a>
       </li>
       <li>
        <a href="#flush-session">
         –flush-session
        </a>
       </li>
       <li>
        <a href="#tamper">
         –tamper=
        </a>
       </li>
      </ul>
     </li>
     <li>
      <a href="#sqlmap-tampers-scripts">
       Sqlmap tampers scripts
      </a>
      <ul>
       <li>
        <a href="#space2comment-py">
         space2comment.py
        </a>
       </li>
       <li>
        <a href="#randomcase-py">
         randomcase.py
        </a>
       </li>
       <li>
        <a href="#equaltolike-py">
         equaltolike.py
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li>
    <a href="#conclusion">
     Conclusion
    </a>
   </li>
  </ul>
 </div>
 <h2 class="wp-block-heading" id="a-quick-reminder-about-sql-injections-sqli">
  A Quick Reminder about SQL Injections (SQLi)
 </h2>
 <p>
  First of all, what does SQL mean?
  <strong>
   “Structured Query Language” is a computer language used to communicate with a database and manipulate stored data.
  </strong>
 </p>
 <p>
  The vast majority of web applications use SQL to query their database. However, depending on the implementation, SQL injection-type vulnerabilities, commonly known as “SQLi”, can emerge.
 </p>
 <h3 class="wp-block-heading has-text-color has-link-color wp-elements-e916bb97f801568ade6305842a96470d" id="what-is-an-sqli" style="color:#c0b800">
  What is an SQLi?
 </h3>
 <p>
  <strong>
   SQL injection is an attack used to manipulate the relational databases of a web application, such as MySQL, Oracle Database or Microsoft SQL Server
  </strong>
  . This should not be confused with NoSQL injections, which are attacks used to manipulate non-relational databases such as MongoDB or CouchDB.
 </p>
 <p>
  For example, consider the following piece of PHP code:
 </p>
 <figure class="wp-block-image size-large">
  <img alt="" class="wp-image-9579" data-lazy-sizes="(max-width: 1024px) 100vw, 1024px" data-lazy-src="article_images\image_2.png" data-lazy-srcset="article_images\image_2.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sql-query-300x41.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sql-query.png 1205w" decoding="async" height="140" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201024%20140'%3E%3C/svg%3E" width="1024"/>
  <noscript>
   <img alt="" class="wp-image-9579" decoding="async" height="140" sizes="(max-width: 1024px) 100vw, 1024px" src="article_images\image_2.png" srcset="article_images\image_2.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sql-query-300x41.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sql-query.png 1205w" width="1024"/>
  </noscript>
  <figcaption class="wp-element-caption">
   SQL Query
  </figcaption>
 </figure>
 <p>
  The first line shows that the $id variable takes the value of the id parameter in the URL. However, this $id variable is concatenated directly in the SQL query on the next line.
 </p>
 <p>
  As the id parameter can be manipulated by any user, an attacker can inject SQL code into the id parameter of the URL and perform a multitude of actions on the web application database.
 </p>
 <p>
  For example, to ensure injection, the attacker could inject a 5-second delay into the id parameter of the URL:
 </p>
 <figure class="wp-block-image size-large">
  <img alt="" class="wp-image-9582" data-lazy-sizes="(max-width: 1024px) 100vw, 1024px" data-lazy-src="article_images\image_3.png" data-lazy-srcset="article_images\image_3.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sql-injection-in-id-parameter-300x40.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sql-injection-in-id-parameter.png 1137w" decoding="async" height="136" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201024%20136'%3E%3C/svg%3E" width="1024"/>
  <noscript>
   <img alt="" class="wp-image-9582" decoding="async" height="136" sizes="(max-width: 1024px) 100vw, 1024px" src="article_images\image_3.png" srcset="article_images\image_3.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sql-injection-in-id-parameter-300x40.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sql-injection-in-id-parameter.png 1137w" width="1024"/>
  </noscript>
  <figcaption class="wp-element-caption">
   <em>
    SQL injection in the id parameter of the URL
   </em>
  </figcaption>
 </figure>
 <p>
  On the server side, the SQL query will be as follows:
 </p>
 <figure class="wp-block-image size-large">
  <img alt="" class="wp-image-9585" data-lazy-sizes="(max-width: 1024px) 100vw, 1024px" data-lazy-src="article_images\image_4.png" data-lazy-srcset="article_images\image_4.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/injected-sql-query-300x32.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/injected-sql-query.png 1191w" decoding="async" height="108" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201024%20108'%3E%3C/svg%3E" width="1024"/>
  <noscript>
   <img alt="" class="wp-image-9585" decoding="async" height="108" sizes="(max-width: 1024px) 100vw, 1024px" src="article_images\image_4.png" srcset="article_images\image_4.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/injected-sql-query-300x32.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/injected-sql-query.png 1191w" width="1024"/>
  </noscript>
  <figcaption class="wp-element-caption">
   Injected SQl query
  </figcaption>
 </figure>
 <p>
  <p class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: 18.4px; font-size: 12pt; font-family: Aptos, sans-serif; color: rgb(0, 0, 0); white-space-collapse: collapse;">
   <span lang="EN-US">
   </span>
  </p>
 </p>
 <p>
  The server will therefore take 5 seconds to respond, confirming the SQL injection.
 </p>
 <h3 class="wp-block-heading has-text-color has-link-color wp-elements-1760bcd07c5d77333db0fc241f745f53" id="impact-of-an-sqli" style="color:#c0b800">
  Impact of an SQLi
 </h3>
 <p>
  In most cases, the impact of an SQL injection is critical. If the database user has sufficient access rights, as is often the case, an SQLi allows an attacker to exfiltrate the entire database from the web application and sometimes even gain control of the server.
 </p>
 <h3 class="wp-block-heading has-text-color has-link-color wp-elements-07a8573f2d5b59a8bd5cdc396e3308e8" id="what-are-the-different-types-of-sqli-and-how-can-they-be-prevented" style="color:#c0b800">
  What are the Different Types of SQLi and How Can They be Prevented?
 </h3>
 <p>
  There are several types of SQL injection. This depends on the point of injection and the technique used to exploit the injection. Below is a non-exhaustive list of SQLi types:
 </p>
 <ul class="wp-block-list">
  <li>
   UNION-based
  </li>
  <li>
   Boolean-based blind
  </li>
  <li>
   Error-based
  </li>
  <li>
   Stacked queries
  </li>
  <li>
   Time-based blind
  </li>
 </ul>
 <p>
  The best way to protect against SQL injections is to use “prepared Statements”, which define the structure of the SQL query before incorporating the variables.
 </p>
 <p>
  This way, if a variable is controlled by an attacker, the latter will not be able to inject itself into the SQL query, as its structure will already have been defined beforehand. For more information and case studies on SQL injections in general, please refer to our detailed article:
  <a href="https://www.vaadata.com/blog/sql-injections-principles-impacts-exploitations-security-best-practices/" rel="noopener" target="_blank" title="">
   SQL injections (SQLi): principles, impacts, exploitations and security best practices
  </a>
  .
 </p>
 <h2 class="wp-block-heading" id="how-does-sqlmap-work">
  How does Sqlmap Work?
 </h2>
 <p>
  Although it is possible to exploit a SQL injection and exfiltrate the contents of a database manually, it is much simpler and quicker to write and use a script.
 </p>
 <p>
  Even better, if you don’t want to reinvent the wheel and want to be even more efficient, sqlmap will be there to help you.
 </p>
 <h3 class="wp-block-heading has-text-color has-link-color wp-elements-ccc374c5955101d017cd36d9e49c292d" id="what-is-sqlmap" style="color:#c0b800">
  What is Sqlmap?
 </h3>
 <p>
  Sqlmap is an open-source tool that automates the detection and exploitation of SQL injections. It is a very comprehensive tool offering a multitude of features and options that can go as far as compromising the SQL server if conditions allow.
 </p>
 <p>
  <em>
   Before going any further, it is important to note that sqlmap potentially generates a lot of traffic and that its use is illegal without authorisation from the owner of the system tested.
  </em>
 </p>
 <h3 class="wp-block-heading has-text-color has-link-color wp-elements-d6a6e6f51aed7434832b494f017f9c02" id="exploiting-an-sqli-with-sqlmap" style="color:#c0b800">
  Exploiting an SQLi with Sqlmap
 </h3>
 <p>
  During a penetration test, sqlmap is generally used after an SQLi has been identified. This ensures that traffic is not generated for nothing. There are then several steps to follow to exploit SQL injection in the classic way.
 </p>
 <p>
  Let’s look at it step by step.
 </p>
 <h4 class="wp-block-heading" id="finding-a-payload-that-suits-the-type-of-sqli">
  Finding a payload that suits the type of SQLi
 </h4>
 <p>
  The first step is to find a payload that is suitable for the type of SQLi and that will be used to exfiltrate the database in the following steps.
 </p>
 <p>
  <strong>
   Command:
  </strong>
 </p>
 <figure class="wp-block-image size-full">
  <img alt="" class="wp-image-9587" data-lazy-sizes="(max-width: 482px) 100vw, 482px" data-lazy-src="article_images\image_5.png" data-lazy-srcset="article_images\image_5.png 482w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-to-find-payload-300x49.png 300w" decoding="async" height="79" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20482%2079'%3E%3C/svg%3E" width="482"/>
  <noscript>
   <img alt="" class="wp-image-9587" decoding="async" height="79" sizes="(max-width: 482px) 100vw, 482px" src="article_images\image_5.png" srcset="article_images\image_5.png 482w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-to-find-payload-300x49.png 300w" width="482"/>
  </noscript>
 </figure>
 <p>
  The “-r” option tells sqlmap the file containing the HTTP request which contains the injection point. If the location of the injection point is known to the attacker, as it is the case in this example, it can be specified by adding an asterisk to the precise location where the SQL injection is to take place:
 </p>
 <figure class="wp-block-image size-large">
  <img alt="" class="wp-image-9589" data-lazy-sizes="(max-width: 1024px) 100vw, 1024px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/req-txt-file-content-1024x320.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/req-txt-file-content-1024x320.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/req-txt-file-content-300x94.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/req-txt-file-content.png 1287w" decoding="async" height="320" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201024%20320'%3E%3C/svg%3E" width="1024"/>
  <noscript>
   <img alt="" class="wp-image-9589" decoding="async" height="320" sizes="(max-width: 1024px) 100vw, 1024px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/req-txt-file-content-1024x320.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/req-txt-file-content-1024x320.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/req-txt-file-content-300x94.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/req-txt-file-content.png 1287w" width="1024"/>
  </noscript>
  <figcaption class="wp-element-caption">
   Content of the req.txt file
  </figcaption>
 </figure>
 <p>
  Here, the attacker knows that an SQL injection is possible in the value of the “TrackingId” cookie.
 </p>
 <p>
  Note that it is also possible to use the “-u” option instead to specify a URL if SQL injection is possible in a URL parameter.
 </p>
 <p>
  <strong>
   Result:
  </strong>
 </p>
 <p>
  After testing several payloads, sqlmap finally found the type of SQL injection:
 </p>
 <figure class="wp-block-image size-large">
  <img alt="" class="wp-image-9591" data-lazy-sizes="(max-width: 1024px) 100vw, 1024px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/payload-and-dbms-identification-1024x521.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/payload-and-dbms-identification-1024x521.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/payload-and-dbms-identification-300x153.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/payload-and-dbms-identification.png 1420w" decoding="async" height="521" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201024%20521'%3E%3C/svg%3E" width="1024"/>
  <noscript>
   <img alt="" class="wp-image-9591" decoding="async" height="521" sizes="(max-width: 1024px) 100vw, 1024px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/payload-and-dbms-identification-1024x521.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/payload-and-dbms-identification-1024x521.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/payload-and-dbms-identification-300x153.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/payload-and-dbms-identification.png 1420w" width="1024"/>
  </noscript>
  <figcaption class="wp-element-caption">
   <em>
    Payload and DBMS identification
   </em>
  </figcaption>
 </figure>
 <p>
  Here, the type of SQL injection is a “stacked query time-based blind”, i.e. it is possible to exfiltrate data by playing with delays, as it is impossible to obtain the result of the SQL injection directly. Also, the injection is carried out with a new query after the original, hence the “stacked query”.
 </p>
 <p>
  At the same time, sqlmap has also identified the database system used, which is PostgreSQL. With this information, sqlmap can now use payloads that respect the injection type and database system to exfiltrate data.
 </p>
 <h4 class="wp-block-heading" id="exfiltrating-database-names">
  Exfiltrating database names
 </h4>
 <p>
  The second step is to exfiltrate the database names. This step can be done at the same time as the first one to save time.
 </p>
 <p>
  <strong>
   Command:
  </strong>
 </p>
 <figure class="wp-block-image size-full">
  <img alt="" class="wp-image-9593" data-lazy-sizes="(max-width: 655px) 100vw, 655px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-database-enumeration.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-database-enumeration.png 655w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-database-enumeration-300x36.png 300w" decoding="async" height="78" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20655%2078'%3E%3C/svg%3E" width="655"/>
  <noscript>
   <img alt="" class="wp-image-9593" decoding="async" height="78" sizes="(max-width: 655px) 100vw, 655px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-database-enumeration.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-database-enumeration.png 655w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-database-enumeration-300x36.png 300w" width="655"/>
  </noscript>
  <figcaption class="wp-element-caption">
   <em>
    sqlmap command for enumerating databases
   </em>
  </figcaption>
 </figure>
 <p>
  To enumerate the databases, add the “-dbs” option.
 </p>
 <p>
  <strong>
   Result:
  </strong>
 </p>
 <figure class="wp-block-image size-full">
  <img alt="" class="wp-image-9595" data-lazy-sizes="(max-width: 648px) 100vw, 648px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/database-list.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/database-list.png 648w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/database-list-300x58.png 300w" decoding="async" height="125" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20648%20125'%3E%3C/svg%3E" width="648"/>
  <noscript>
   <img alt="" class="wp-image-9595" decoding="async" height="125" sizes="(max-width: 648px) 100vw, 648px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/database-list.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/database-list.png 648w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/database-list-300x58.png 300w" width="648"/>
  </noscript>
  <figcaption class="wp-element-caption">
   <em>
    List of databases
   </em>
  </figcaption>
 </figure>
 <p>
  Here, only one database has been found, the “public” database.
 </p>
 <h4 class="wp-block-heading" id="listing-the-table-names">
  Listing the table names
 </h4>
 <p>
  In the third step, now that we know the name of the database, we can list the names of the tables.
 </p>
 <p>
  <strong>
   Command:
  </strong>
 </p>
 <figure class="wp-block-image size-full">
  <img alt="" class="wp-image-9597" data-lazy-sizes="(max-width: 954px) 100vw, 954px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sql-command-tables-enumeration.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sql-command-tables-enumeration.png 954w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sql-command-tables-enumeration-300x20.png 300w" decoding="async" height="65" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20954%2065'%3E%3C/svg%3E" width="954"/>
  <noscript>
   <img alt="" class="wp-image-9597" decoding="async" height="65" sizes="(max-width: 954px) 100vw, 954px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sql-command-tables-enumeration.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sql-command-tables-enumeration.png 954w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sql-command-tables-enumeration-300x20.png 300w" width="954"/>
  </noscript>
  <figcaption class="wp-element-caption">
   <em>
    sqlmap command for enumerating tables
   </em>
  </figcaption>
 </figure>
 <p>
  The “
  <strong>
   -D
  </strong>
  ” option specifies the name of the database, in this case “public”, and the “
  <strong>
   -tables
  </strong>
  ” option is used to enumerate the names of the tables present in the “public” database.
 </p>
 <p>
  <strong>
   Result:
  </strong>
 </p>
 <figure class="wp-block-image size-full">
  <img alt="" class="wp-image-9599" data-lazy-sizes="(max-width: 408px) 100vw, 408px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/tables-list.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/tables-list.png 408w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/tables-list-300x206.png 300w" decoding="async" height="280" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20408%20280'%3E%3C/svg%3E" width="408"/>
  <noscript>
   <img alt="" class="wp-image-9599" decoding="async" height="280" sizes="(max-width: 408px) 100vw, 408px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/tables-list.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/tables-list.png 408w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/tables-list-300x206.png 300w" width="408"/>
  </noscript>
 </figure>
 <p>
  Two tables were found, “tracking” and “users”. The second table looks interesting and may contain data relating to the platform’s users.
 </p>
 <h4 class="wp-block-heading" id="choosing-an-interesting-table">
  Choosing an interesting table
 </h4>
 <p>
  The fourth step is to choose an interesting table to dig into. To do this, we list its columns.
 </p>
 <p>
  <strong>
   Command:
  </strong>
 </p>
 <figure class="wp-block-image size-large">
  <img alt="" class="wp-image-9601" data-lazy-sizes="(max-width: 1024px) 100vw, 1024px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-columns-enumeration-1024x53.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-columns-enumeration-1024x53.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-columns-enumeration-300x16.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-columns-enumeration.png 1160w" decoding="async" height="53" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201024%2053'%3E%3C/svg%3E" width="1024"/>
  <noscript>
   <img alt="" class="wp-image-9601" decoding="async" height="53" sizes="(max-width: 1024px) 100vw, 1024px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-columns-enumeration-1024x53.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-columns-enumeration-1024x53.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-columns-enumeration-300x16.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-columns-enumeration.png 1160w" width="1024"/>
  </noscript>
  <figcaption class="wp-element-caption">
   <em>
    sqlmap command for enumerating columns
   </em>
  </figcaption>
 </figure>
 <p>
  The “
  <strong>
   -T
  </strong>
  ” option is used to specify the “users” table and the “
  <strong>
   -columns
  </strong>
  ” option to list the column names.
 </p>
 <p>
  <strong>
   Result:
  </strong>
 </p>
 <figure class="wp-block-image size-full">
  <img alt="" class="wp-image-9603" data-lazy-sizes="(max-width: 467px) 100vw, 467px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/columns-list.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/columns-list.png 467w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/columns-list-300x255.png 300w" decoding="async" height="397" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20467%20397'%3E%3C/svg%3E" width="467"/>
  <noscript>
   <img alt="" class="wp-image-9603" decoding="async" height="397" sizes="(max-width: 467px) 100vw, 467px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/columns-list.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/columns-list.png 467w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/columns-list-300x255.png 300w" width="467"/>
  </noscript>
  <figcaption class="wp-element-caption">
   Columns list
  </figcaption>
 </figure>
 <h4 class="wp-block-heading" id="listing-the-table-data">
  Listing the table data
 </h4>
 <p>
  For the fifth and final step, now that we have an overview of the “users” table, we can choose to enumerate all the data in the table or just the data in certain columns. In our case, we are enumerating the data in the “username” and “password” columns.
 </p>
 <p>
  <strong>
   Command:
  </strong>
 </p>
 <figure class="wp-block-image size-large">
  <img alt="" class="wp-image-9606" data-lazy-sizes="(max-width: 1024px) 100vw, 1024px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmqp-command-data-dump-1024x40.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmqp-command-data-dump-1024x40.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmqp-command-data-dump-300x12.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmqp-command-data-dump.png 1416w" decoding="async" height="40" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201024%2040'%3E%3C/svg%3E" width="1024"/>
  <noscript>
   <img alt="" class="wp-image-9606" decoding="async" height="40" sizes="(max-width: 1024px) 100vw, 1024px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmqp-command-data-dump-1024x40.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmqp-command-data-dump-1024x40.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmqp-command-data-dump-300x12.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmqp-command-data-dump.png 1416w" width="1024"/>
  </noscript>
  <figcaption class="wp-element-caption">
   <em>
    sqlmap command for exfiltrating table data
   </em>
  </figcaption>
 </figure>
 <p>
  With the “
  <strong>
   -C
  </strong>
  ” option, we choose our columns separated by a comma. The “
  <strong>
   -dump
  </strong>
  ” option is used to exfiltrate the table data.
 </p>
 <p>
  <strong>
   Result:
  </strong>
 </p>
 <figure class="wp-block-image size-full">
  <img alt="" class="wp-image-9608" data-lazy-sizes="(max-width: 907px) 100vw, 907px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/dumped-data-list.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/dumped-data-list.png 907w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/dumped-data-list-300x147.png 300w" decoding="async" height="443" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20907%20443'%3E%3C/svg%3E" width="907"/>
  <noscript>
   <img alt="" class="wp-image-9608" decoding="async" height="443" sizes="(max-width: 907px) 100vw, 907px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/dumped-data-list.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/dumped-data-list.png 907w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/dumped-data-list-300x147.png 300w" width="907"/>
  </noscript>
  <figcaption class="wp-element-caption">
   <em>
    List of exfiltrated data
   </em>
  </figcaption>
 </figure>
 <p>
  So, we’ve managed to exfiltrate the name and password of every user on the platform using sqlmap.
 </p>
 <h3 class="wp-block-heading has-text-color has-link-color wp-elements-bfa2658318bae540fc41e9d15db18b9b" id="using-sqlmap-to-retrieve-system-information" style="color:#c0b800">
  Using Sqlmap to retrieve system information
 </h3>
 <p>
  To go further and establish a better understanding of the environment under attack, it is always interesting to retrieve information linked to the database system. With sqlmap, you can retrieve:
 </p>
 <ul class="wp-block-list">
  <li>
   The system user currently using the database
  </li>
  <li>
   Whether or not the current system user has the DBA (Data Base Administrator) role
  </li>
  <li>
   The host name
  </li>
  <li>
   All system users of the database
  </li>
  <li>
   The privileges of all system users
  </li>
 </ul>
 <p>
  Below are the commands used to retrieve this information and their results:
 </p>
 <p>
  <strong>
   System user currently using the database
  </strong>
 </p>
 <p>
  <strong>
   Command:
  </strong>
 </p>
 <figure class="wp-block-image size-full">
  <img alt="" class="wp-image-9625" data-lazy-sizes="(max-width: 779px) 100vw, 779px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-current-user.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-current-user.png 779w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-current-user-300x25.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-current-user-770x65.png 770w" decoding="async" height="65" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20779%2065'%3E%3C/svg%3E" width="779"/>
  <noscript>
   <img alt="" class="wp-image-9625" decoding="async" height="65" sizes="(max-width: 779px) 100vw, 779px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-current-user.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-current-user.png 779w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-current-user-300x25.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-current-user-770x65.png 770w" width="779"/>
  </noscript>
 </figure>
 <p>
  <strong>
   Result:
  </strong>
 </p>
 <figure class="wp-block-image size-full">
  <img alt="" class="wp-image-9628" data-lazy-sizes="(max-width: 595px) 100vw, 595px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-user-sqlmap.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-user-sqlmap.png 595w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-user-sqlmap-300x37.png 300w" decoding="async" height="73" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20595%2073'%3E%3C/svg%3E" width="595"/>
  <noscript>
   <img alt="" class="wp-image-9628" decoding="async" height="73" sizes="(max-width: 595px) 100vw, 595px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-user-sqlmap.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-user-sqlmap.png 595w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-user-sqlmap-300x37.png 300w" width="595"/>
  </noscript>
 </figure>
 <p>
  <strong>
   Is the current system user DBA?
  </strong>
 </p>
 <p>
  <strong>
   Command:
  </strong>
 </p>
 <figure class="wp-block-image size-full">
  <img alt="" class="wp-image-9630" data-lazy-sizes="(max-width: 673px) 100vw, 673px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-dba.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-dba.png 673w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-dba-300x28.png 300w" decoding="async" height="62" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20673%2062'%3E%3C/svg%3E" width="673"/>
  <noscript>
   <img alt="" class="wp-image-9630" decoding="async" height="62" sizes="(max-width: 673px) 100vw, 673px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-dba.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-dba.png 673w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-dba-300x28.png 300w" width="673"/>
  </noscript>
 </figure>
 <p>
  <strong>
   Result:
  </strong>
 </p>
 <figure class="wp-block-image size-full">
  <img alt="" class="wp-image-9632" data-lazy-sizes="(max-width: 632px) 100vw, 632px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-dba-sqlmap.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-dba-sqlmap.png 632w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-dba-sqlmap-300x27.png 300w" decoding="async" height="57" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20632%2057'%3E%3C/svg%3E" width="632"/>
  <noscript>
   <img alt="" class="wp-image-9632" decoding="async" height="57" sizes="(max-width: 632px) 100vw, 632px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-dba-sqlmap.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-dba-sqlmap.png 632w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-dba-sqlmap-300x27.png 300w" width="632"/>
  </noscript>
 </figure>
 <p>
  <strong>
   Host name
  </strong>
 </p>
 <p>
  <strong>
   Command:
  </strong>
 </p>
 <figure class="wp-block-image size-full">
  <img alt="" class="wp-image-9634" data-lazy-sizes="(max-width: 737px) 100vw, 737px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-hostname.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-hostname.png 737w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-hostname-300x28.png 300w" decoding="async" height="69" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20737%2069'%3E%3C/svg%3E" width="737"/>
  <noscript>
   <img alt="" class="wp-image-9634" decoding="async" height="69" sizes="(max-width: 737px) 100vw, 737px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-hostname.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-hostname.png 737w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-hostname-300x28.png 300w" width="737"/>
  </noscript>
 </figure>
 <p>
  <strong>
   Result:
  </strong>
 </p>
 <figure class="wp-block-image size-full">
  <img alt="" class="wp-image-9636" data-lazy-sizes="(max-width: 664px) 100vw, 664px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-hostname-sqlmap.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-hostname-sqlmap.png 664w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-hostname-sqlmap-300x29.png 300w" decoding="async" height="65" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20664%2065'%3E%3C/svg%3E" width="664"/>
  <noscript>
   <img alt="" class="wp-image-9636" decoding="async" height="65" sizes="(max-width: 664px) 100vw, 664px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-hostname-sqlmap.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-hostname-sqlmap.png 664w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-hostname-sqlmap-300x29.png 300w" width="664"/>
  </noscript>
 </figure>
 <p>
  <strong>
   List of system users in the database
  </strong>
 </p>
 <p>
  <strong>
   Command:
  </strong>
 </p>
 <figure class="wp-block-image size-full">
  <img alt="" class="wp-image-9638" data-lazy-sizes="(max-width: 623px) 100vw, 623px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-users.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-users.png 623w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-users-300x31.png 300w" decoding="async" height="64" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20623%2064'%3E%3C/svg%3E" width="623"/>
  <noscript>
   <img alt="" class="wp-image-9638" decoding="async" height="64" sizes="(max-width: 623px) 100vw, 623px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-users.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-users.png 623w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-users-300x31.png 300w" width="623"/>
  </noscript>
 </figure>
 <p>
  <strong>
   Result:
  </strong>
 </p>
 <figure class="wp-block-image size-full">
  <img alt="" class="wp-image-9640" data-lazy-sizes="(max-width: 845px) 100vw, 845px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-users-sqlmap.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-users-sqlmap.png 845w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-users-sqlmap-300x39.png 300w" decoding="async" height="111" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20845%20111'%3E%3C/svg%3E" width="845"/>
  <noscript>
   <img alt="" class="wp-image-9640" decoding="async" height="111" sizes="(max-width: 845px) 100vw, 845px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-users-sqlmap.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-users-sqlmap.png 845w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-users-sqlmap-300x39.png 300w" width="845"/>
  </noscript>
 </figure>
 <p>
  <strong>
   Privileges of the database’s system users
  </strong>
 </p>
 <p>
  <strong>
   Command:
  </strong>
 </p>
 <figure class="wp-block-image size-full">
  <img alt="" class="wp-image-9642" data-lazy-sizes="(max-width: 791px) 100vw, 791px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-privileges.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-privileges.png 791w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-privileges-300x25.png 300w" decoding="async" height="65" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20791%2065'%3E%3C/svg%3E" width="791"/>
  <noscript>
   <img alt="" class="wp-image-9642" decoding="async" height="65" sizes="(max-width: 791px) 100vw, 791px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-privileges.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-privileges.png 791w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-command-privileges-300x25.png 300w" width="791"/>
  </noscript>
 </figure>
 <p>
  <strong>
   Result:
  </strong>
 </p>
 <figure class="wp-block-image size-large">
  <img alt="" class="wp-image-9644" data-lazy-sizes="(max-width: 1024px) 100vw, 1024px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-privileges-sqlmap-1024x148.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-privileges-sqlmap-1024x148.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-privileges-sqlmap-300x43.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-privileges-sqlmap.png 1109w" decoding="async" height="148" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201024%20148'%3E%3C/svg%3E" width="1024"/>
  <noscript>
   <img alt="" class="wp-image-9644" decoding="async" height="148" sizes="(max-width: 1024px) 100vw, 1024px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-privileges-sqlmap-1024x148.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-privileges-sqlmap-1024x148.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-privileges-sqlmap-300x43.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/finding-privileges-sqlmap.png 1109w" width="1024"/>
  </noscript>
 </figure>
 <p>
  <a href="https://portswigger.net/web-security/sql-injection" rel="noopener" target="_blank" title="">
   Sources of the labs on Portswigger
  </a>
 </p>
 <h3 class="wp-block-heading has-text-color has-link-color wp-elements-0affb94b2912a7e6e4a2c504dafce4eb" id="exploiting-blind-sql-injections-with-sqlmap" style="color:#c0b800">
  Exploiting blind SQL injections with Sqlmap
 </h3>
 <p>
  SQL injection results are often not returned in response, as in the case of blind sql injections. So how does sqlmap manage to exfiltrate the data?
 </p>
 <p>
  If an SQL injection is of the blind type, you need to find a condition that returns a different server response depending on whether it is true or false. For example, in the case of a Boolean blind SQLi, the server will respond in a different way if a Boolean condition in the injected query is false:
 </p>
 <figure class="wp-block-image size-large">
  <img alt="" class="wp-image-9614" data-lazy-sizes="(max-width: 1024px) 100vw, 1024px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/boolean-sql-query-1024x159.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/boolean-sql-query-1024x159.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/boolean-sql-query-300x47.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/boolean-sql-query.png 1398w" decoding="async" height="159" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201024%20159'%3E%3C/svg%3E" width="1024"/>
  <noscript>
   <img alt="" class="wp-image-9614" decoding="async" height="159" sizes="(max-width: 1024px) 100vw, 1024px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/boolean-sql-query-1024x159.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/boolean-sql-query-1024x159.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/boolean-sql-query-300x47.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/boolean-sql-query.png 1398w" width="1024"/>
  </noscript>
  <figcaption class="wp-element-caption">
   <em>
    SQL query with Boolean condition
   </em>
  </figcaption>
 </figure>
 <p>
  If the server does respond differently, it is possible to exploit this and retrieve the database names character by character, then the tables, then the columns and finally the data.
 </p>
 <p>
  With the following injection, for example, if we keep our example of injection in the product ID, we can find out whether the first character of the password for the user “administrator” in the “password” column of the “users” table is equal to “5” or not:
 </p>
 <figure class="wp-block-image size-large">
  <img alt="" class="wp-image-9617" data-lazy-sizes="(max-width: 1024px) 100vw, 1024px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/boolean-based-blind-sqli-1024x67.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/boolean-based-blind-sqli-1024x67.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/boolean-based-blind-sqli-300x20.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/boolean-based-blind-sqli.png 1415w" decoding="async" height="67" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201024%2067'%3E%3C/svg%3E" width="1024"/>
  <noscript>
   <img alt="" class="wp-image-9617" decoding="async" height="67" sizes="(max-width: 1024px) 100vw, 1024px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/boolean-based-blind-sqli-1024x67.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/boolean-based-blind-sqli-1024x67.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/boolean-based-blind-sqli-300x20.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/boolean-based-blind-sqli.png 1415w" width="1024"/>
  </noscript>
  <figcaption class="wp-element-caption">
   <em>
    Boolean-based blind SQLi
   </em>
  </figcaption>
 </figure>
 <p>
  The complete server-side query will therefore be:
 </p>
 <figure class="wp-block-image size-large">
  <img alt="" class="wp-image-9620" data-lazy-sizes="(max-width: 1024px) 100vw, 1024px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/injected-sql-query-2-1024x30.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/injected-sql-query-2-1024x30.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/injected-sql-query-2-300x9.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/injected-sql-query-2.png 1418w" decoding="async" height="30" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201024%2030'%3E%3C/svg%3E" width="1024"/>
  <noscript>
   <img alt="" class="wp-image-9620" decoding="async" height="30" sizes="(max-width: 1024px) 100vw, 1024px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/injected-sql-query-2-1024x30.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/injected-sql-query-2-1024x30.png 1024w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/injected-sql-query-2-300x9.png 300w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/injected-sql-query-2.png 1418w" width="1024"/>
  </noscript>
 </figure>
 <p>
  As the password does start with “5”, the server responds differently than if we had entered another number or letter instead.
 </p>
 <p>
  We can move on to the next characters by incrementing the second parameter of the SQL SUBSTRING() function. Note that this method works because we know that the database system is PostgreSQL and that the type of SQLi is a boolean-based blind.
 </p>
 <p>
  The power of sqlmap lies in its ability to automate and consider most cases of SQL injection. The sqlmap tool is very complete and is useful for exploiting many other types of SQL injection, not just blinds. In the next section, we’ll look at some of sqlmap’s many “advanced” options, as well as the “tampers” notion.
 </p>
 <h3 class="wp-block-heading has-text-color has-link-color wp-elements-f565500103a4bffdf46040d589cbcf0c" id="sqlmap-advanced-options" style="color:#c0b800">
  Sqlmap advanced options
 </h3>
 <p>
  It’s no exaggeration to say that sqlmap is a complete SQLi tool. Try displaying the full help with the “
  <strong>
   -hh
  </strong>
  ” option and you will already have an idea of the power of this tool.
 </p>
 <p>
  In this section, we list some options that may come in handy during a pentest, but don’t limit yourself to them, we strongly recommend you explore the many nuances of this tool for yourself.
 </p>
 <h4 class="wp-block-heading" id="proxy">
  –proxy=
 </h4>
 <p>
  To understand exactly what sqlmap is sending, it is possible to view each request sent and its response by specifying a proxy. For example, you can pass all the traffic generated by sqlmap through
  <a href="https://www.vaadata.com/blog/introduction-to-burp-suite-the-tool-dedicated-to-web-application-security/" rel="noopener" target="_blank" title="">
   Burp Suite
  </a>
  .
 </p>
 <p>
  This can be used to understand and resolve cases where sqlmap is not working as expected by seeing directly how the server responds to requests sent by sqlmap.
 </p>
 <h4 class="wp-block-heading" id="delay">
  –delay=
 </h4>
 <p>
  <a href="https://www.vaadata.com/blog/what-is-rate-limiting-how-it-works-and-implementation-techniques/" rel="noopener" target="_blank" title="">
   Rate limiting
  </a>
  is sometimes implemented on some web applications.
 </p>
 <p>
  The heavy traffic generated by sqlmap can activate alerts on the server which will block any new requests from us. To go around this problem, you can use the “–delay” option, which specifies a delay in seconds between each request sent by sqlmap.
 </p>
 <p>
  By playing with this delay, you can potentially bypass rate limiting, but data exfiltration will take longer.
 </p>
 <h4 class="wp-block-heading" id="force-ssl">
  –force-ssl
 </h4>
 <p>
  When the server does not accept the use of the HTTP protocol and you specify a request file with the “-r” option, the “–force-ssl” option allows you to force the use of HTTPS on requests sent.
 </p>
 <p>
  This is a simple option, but an important one to add to your command for secure data exfiltration.
 </p>
 <h4 class="wp-block-heading" id="threads">
  –threads=
 </h4>
 <p>
  If you know that the server can handle a lot of traffic, it is a good idea to increase the number of threads in your sqlmap command to retrieve data more quickly. Be careful, however, not to overuse this as it could cause the SQL server to crash.
 </p>
 <h4 class="wp-block-heading" id="dbms">
  –dbms=
 </h4>
 <p>
  For optimisation reasons, if you know the database system used by the SQL server, it is possible to specify it to sqlmap. This reduces the time taken to detect the type of SQLi, as sqlmap will only test payloads linked to the DBMS specified.
 </p>
 <h4 class="wp-block-heading" id="level">
  –level=
 </h4>
 <p>
  The “–level” option is used to specify to sqlmap the completeness of the tests to be performed. The value goes from 1 to 5, it being 1 by default. The higher the value, the greater the number of payloads tested.
 </p>
 <p>
  This is a practical option for complex cases of SQL injection. If sqlmap doesn’t find an injection payload the first time, it is a good idea to increase the value of this option.
 </p>
 <h4 class="wp-block-heading" id="risk">
  –risk=
 </h4>
 <p>
  Like the previous option, the “–risk” option can be used to specify an accepted risk level from 1 to 3. The higher the value, the greater the number of payloads injected by sqlmap, but also the greater the risk.
 </p>
 <p>
  Depending on the location of the injection in the original SQL query, increasing the risk can lead to unwanted data modifications. By default, this value is set to 1.
 </p>
 <h4 class="wp-block-heading" id="string">
  –string=
 </h4>
 <p>
  In the case of boolean-based SQL injections, it is possible to specify to sqlmap a character string to look for in the server response if the injected condition is true.
 </p>
 <p>
  As we saw earlier, in the case of a boolean-based blind, the server response is different if the injected condition is true or false. If it’s true, the difference can be as simple as a string of characters in the server response, which is why it is a good idea to specify it in sqlmap.
 </p>
 <h4 class="wp-block-heading" id="technique">
  –technique=
 </h4>
 <p>
  It is possible to specify to sqlmap the type of payloads to be tested and their order. An SQL injection can be of several different types and can, for example, be a boolean-based blind and a time-based blind at the same time.
 </p>
 <p>
  However, a boolean-based blind payload will be quicker to exploit than a time-based blind payload. Using the “–technique” option, you can tell sqlmap what type of SQLi to search and find for.
 </p>
 <p>
  Below are the values that the option can take and what they mean:
 </p>
 <ul class="wp-block-list">
  <li>
   B: Boolean-based blind
  </li>
  <li>
   E: Error-based
  </li>
  <li>
   U: Union query-based
  </li>
  <li>
   S: Stacked queries
  </li>
  <li>
   T: Time-based blind
  </li>
  <li>
   Q: Inline queries
  </li>
 </ul>
 <p>
  You can choose to put only one value or all of them in a specific order, which sqlmap will follow. The default order is: BEUSTQ.
 </p>
 <h4 class="wp-block-heading" id="file-read">
  –file-read=
 </h4>
 <p>
  On some database systems, such as MySQL, PostgreSQL or Microsoft SQL Server, it sometimes happens that the database user has sufficient rights to read files on the system. With the “–file-read” option, you can specify the path of the file to be retrieved.
 </p>
 <h4 class="wp-block-heading" id="os-cmd">
  –os-cmd=
 </h4>
 <p>
  As with the previous option, the “–os-cmd” option is used to execute a command on the SQL server. This option only works on MySQL, PostgreSQL or Microsoft SQL Server DBMS and the database user must have sufficient rights.
 </p>
 <h4 class="wp-block-heading" id="flush-session">
  –flush-session
 </h4>
 <p>
  By default, when you use sqlmap on a target, it creates a session relating to the target which it keeps in memory on your machine.
 </p>
 <p>
  So, if you give sqlmap the same query, it will be able to continue exploiting the SQLi straight away, as it will have all the necessary information already in memory (payload, database structure already found, etc.) and it will not need to start from the beginning.
 </p>
 <p>
  If, on the other hand, you want sqlmap to start from scratch on your target, use this option once to delete the saved session.
 </p>
 <h4 class="wp-block-heading" id="tamper">
  –tamper=
 </h4>
 <p>
  This option extends sqlmap’s flexibility. With this option, you can specify one or more scripts which modify the payload before it is sent to the target.
 </p>
 <p>
  In the following section, we will develop the notion of tamper scripts and look at a few concrete examples.
 </p>
 <p>
  For more information on all the sqlmap options, please refer to the
  <a href="https://github.com/sqlmapproject/sqlmap/wiki/Usage" rel="noopener" target="_blank" title="">
   wiki
  </a>
  .
 </p>
 <h3 class="wp-block-heading has-text-color has-link-color wp-elements-f0e2fdcd079fcdc5f3a08a5657f7a4d0" id="sqlmap-tampers-scripts" style="color:#c0b800">
  Sqlmap tampers scripts
 </h3>
 <p>
  Tampers scripts are scripts used to modify the payloads sent by sqlmap to bypass some applications filters or WAF set up. For example, a web application could very well forbid the use of spaces on a user entry.
 </p>
 <p>
  Once the auditor has identified an SQL injection in this same entry, he will need to find a way of bypassing this filter to exploit the SQL injection. This is where tampers scripts can be used. There are scripts already implemented by sqlmap that the user can utilize, but it is entirely possible to create your own for unique situations.
 </p>
 <p>
  To list the tampers scripts already implemented by sqlmap, use the following command:
 </p>
 <figure class="wp-block-image size-full">
  <img alt="" class="wp-image-9622" data-lazy-sizes="(max-width: 577px) 100vw, 577px" data-lazy-src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-tampers-list.png" data-lazy-srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-tampers-list.png 577w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-tampers-list-300x34.png 300w" decoding="async" height="65" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20577%2065'%3E%3C/svg%3E" width="577"/>
  <noscript>
   <img alt="" class="wp-image-9622" decoding="async" height="65" sizes="(max-width: 577px) 100vw, 577px" src="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-tampers-list.png" srcset="https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-tampers-list.png 577w, https://www.vaadata.com/blog/wp-content/uploads/2024/05/sqlmap-tampers-list-300x34.png 300w" width="577"/>
  </noscript>
  <figcaption class="wp-element-caption">
   <em>
    Command to list tampers scripts
   </em>
  </figcaption>
 </figure>
 <p>
  Among the sixty or so tampers already available, we can mention a few:
 </p>
 <h4 class="wp-block-heading" id="space2comment-py">
  space2comment.py
 </h4>
 <p>
  This script replaces all spaces in a payload with comments such as “/**/”. This way, by opening and closing a comment immediately, it can be interpreted as a space by some database systems. This script can therefore be used to bypass simple “anti-SQLi” filters implemented by some web applications that would only block user entries containing spaces
 </p>
 <h4 class="wp-block-heading" id="randomcase-py">
  <strong>
   randomcase.py
  </strong>
 </h4>
 <p>
  The “randomcase.py” script can be used to change the case of all SQL keywords, such as “SELECT”, “WHERE” and so on. For example, “SELECT” can become “SelEcT”. Some application filters or WAFs check that there are no SQL keywords in user entries to protect against SQL injections. However, if this filter is poorly implemented, changing the case can potentially bypass the protection.
 </p>
 <h4 class="wp-block-heading" id="equaltolike-py">
  <strong>
   equaltolike.py
  </strong>
 </h4>
 <p>
  This script changes all the “=” signs in a payload to the equivalent “LIKE” to bypass application filters that prevent the use of the equal sign in user input.
 </p>
 <p>
  It is important to note that these scripts can be used at the same time to bypass several filters at once.
 </p>
 <h2 class="wp-block-heading" id="conclusion">
  Conclusion
 </h2>
 <p>
  Sqlmap is an essential tool for anyone wanting to detect and exploit SQL injections. It provides a range of functions that can meet both basic and more advanced needs. All these qualities make it a powerful tool, essential for pentesters.
 </p>
 <p>
  <strong>
   Author: Lorenzo CARTE – Pentester @Vaadata
  </strong>
 </p>
</div>

    </div>
</body>
</html>
        